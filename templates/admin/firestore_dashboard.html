{% extends "admin/base_site.html" %}

{% block page_title %}Dashboard{% endblock %}

{% block admin_content %}
<!-- Welcome Section -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card-body">
        <h2 class="card-title mb-3">
          <i class="fas fa-tachometer-alt text-primary"></i>
          Welcome to PetMood Admin Dashboard
        </h2>
        <p class="card-text text-muted">
          Monitor your pet emotion detection platform with real-time analytics and insights.
        </p>
      </div>
    </div>
  </div>
</div>

<!-- Statistics Cards -->
<div class="stats-cards-container mb-4">
  <div class="row justify-content-center">
  <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 mb-4">
    <div class="stats-card">
      <div class="stats-icon" style="background: linear-gradient(135deg, #3498db, #2980b9);">
        <i class="fas fa-users"></i>
      </div>
      <div class="stats-number text-primary">{{ total_users|default:0 }}</div>
      <div class="stats-label">Total Users</div>
      <a href="/admin-panel/users/" class="btn btn-outline-primary btn-sm mt-2">
        <i class="fas fa-eye"></i> View Details
      </a>
    </div>
  </div>
  
  <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 mb-4">
    <div class="stats-card">
      <div class="stats-icon" style="background: linear-gradient(135deg, #27ae60, #229954);">
        <i class="fas fa-paw"></i>
      </div>
      <div class="stats-number text-success">{{ total_pets|default:0 }}</div>
      <div class="stats-label">Total Pets</div>
      <a href="/admin-panel/pets/" class="btn btn-outline-success btn-sm mt-2">
        <i class="fas fa-eye"></i> View Details
      </a>
    </div>
  </div>
  
  <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 mb-4">
    <div class="stats-card">
      <div class="stats-icon" style="background: linear-gradient(135deg, #f39c12, #e67e22);">
        <i class="fas fa-chart-line"></i>
      </div>
      <div class="stats-number text-warning">{{ total_scans|default:0 }}</div>
      <div class="stats-label">Total Scans</div>
      <a href="/admin-panel/logs/" class="btn btn-outline-warning btn-sm mt-2">
        <i class="fas fa-eye"></i> View Details
      </a>
    </div>
  </div>
  
  <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 mb-4">
    <div class="stats-card">
      <div class="stats-icon" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
        <i class="fas fa-headset"></i>
      </div>
      <div class="stats-number text-danger">{{ total_support|default:0 }}</div>
      <div class="stats-label">Support Messages</div>
      <a href="/admin-panel/support/" class="btn btn-outline-danger btn-sm mt-2">
        <i class="fas fa-eye"></i> View Details
      </a>
    </div>
  </div>
  </div>
</div>

<!-- Charts Section -->
<div class="row mb-4">
  <div class="col-xl-6 col-lg-12 mb-4">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-chart-line text-primary"></i>
          Scans Trend (Last 7 Days)
        </h5>
      </div>
      <div class="card-body">
        <div style="height: 300px; position: relative;">
          <canvas id="scansChart"></canvas>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-xl-6 col-lg-12 mb-4">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-pie-chart text-success"></i>
          Emotion Distribution
        </h5>
      </div>
      <div class="card-body">
        <div style="height: 300px; position: relative;">
          <canvas id="emotionChart"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Recent Activity Section -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-clock text-info"></i>
          Recent Activity
        </h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-4 mb-3">
            <div class="d-flex align-items-center">
              <div class="bg-primary rounded-circle p-3 me-3">
                <i class="fas fa-user-plus text-white"></i>
              </div>
              <div>
                <h6 class="mb-1">New Users</h6>
                <p class="text-muted mb-0">Recently registered users</p>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <div class="d-flex align-items-center">
              <div class="bg-success rounded-circle p-3 me-3">
                <i class="fas fa-paw text-white"></i>
              </div>
              <div>
                <h6 class="mb-1">Pet Registrations</h6>
                <p class="text-muted mb-0">New pets added to the platform</p>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <div class="d-flex align-items-center">
              <div class="bg-warning rounded-circle p-3 me-3">
                <i class="fas fa-heart text-white"></i>
              </div>
              <div>
                <h6 class="mb-1">Emotion Scans</h6>
                <p class="text-muted mb-0">Recent emotion detection scans</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Quick Actions -->
<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-bolt text-warning"></i>
          Quick Actions
        </h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-lg-3 col-md-6 col-sm-6 mb-3">
            <a href="/admin-panel/users/" class="btn btn-outline-primary w-100">
              <i class="fas fa-users"></i><br>
              <small>Manage Users</small>
            </a>
          </div>
          <div class="col-lg-3 col-md-6 col-sm-6 mb-3">
            <a href="/admin-panel/pets/" class="btn btn-outline-success w-100">
              <i class="fas fa-paw"></i><br>
              <small>Manage Pets</small>
            </a>
          </div>
          <div class="col-lg-3 col-md-6 col-sm-6 mb-3">
            <a href="/admin-panel/logs/" class="btn btn-outline-warning w-100">
              <i class="fas fa-chart-line"></i><br>
              <small>View Logs</small>
            </a>
          </div>
          <div class="col-lg-3 col-md-6 col-sm-6 mb-3">
            <a href="/admin-panel/support/" class="btn btn-outline-info w-100">
              <i class="fas fa-headset"></i><br>
              <small>Support</small>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Chart data
  const days = {{ chart_days|safe }};
  const values = {{ chart_values|safe }};
  const emoLabels = {{ emotion_labels|safe }};
  const emoValues = {{ emotion_values|safe }};

  // Scans Chart
  const scansCtx = document.getElementById('scansChart').getContext('2d');
  new Chart(scansCtx, {
    type: 'line',
    data: {
      labels: days,
      datasets: [{
        label: 'Scans',
        data: values,
        borderColor: '#3498db',
        backgroundColor: 'rgba(52, 152, 219, 0.1)',
        borderWidth: 3,
        fill: true,
        tension: 0.4,
        pointBackgroundColor: '#3498db',
        pointBorderColor: '#fff',
        pointBorderWidth: 2,
        pointRadius: 6
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          display: false
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          grid: {
            color: 'rgba(0,0,0,0.1)'
          }
        },
        x: {
          grid: {
            color: 'rgba(0,0,0,0.1)'
          }
        }
      }
    }
  });

  // Emotion Chart
  const emotionCtx = document.getElementById('emotionChart').getContext('2d');
  new Chart(emotionCtx, {
    type: 'doughnut',
    data: {
      labels: emoLabels,
      datasets: [{
        data: emoValues,
        backgroundColor: [
          '#27ae60',
          '#e74c3c',
          '#f39c12',
          '#3498db',
          '#9b59b6',
          '#1abc9c',
          '#e67e22',
          '#95a5a6'
        ],
        borderWidth: 3,
        borderColor: '#fff'
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          position: 'bottom',
          labels: {
            padding: 20,
            usePointStyle: true
          }
        }
      }
    }
  });
});
</script>
{% endblock %}



{% extends "admin/base_site.html" %}
{% block content %}
<div class="container-fluid py-2">
  <div class="d-flex justify-content-between align-items-center mb-2 flex-wrap gap-2">
    <h1 class="h4 mb-0">Users</h1>
    <form method="get" class="d-flex gap-2 flex-wrap">
      <input class="form-control" style="max-width:180px" type="text" name="name" placeholder="Name" value="{{ request.GET.name }}">
      <input class="form-control" style="max-width:220px" type="text" name="email" placeholder="Email" value="{{ request.GET.email }}">
      <input class="form-control" style="max-width:160px" type="text" name="number" placeholder="Number" value="{{ request.GET.number }}">
      <select class="form-select" style="max-width:180px" name="phoneVerified">
        <option value="">Phone Verified</option>
        <option value="yes" {% if request.GET.phoneVerified == 'yes' %}selected{% endif %}>Yes</option>
        <option value="no" {% if request.GET.phoneVerified == 'no' %}selected{% endif %}>No</option>
      </select>
      <button class="btn btn-primary" type="submit">Filter</button>
      <a class="btn btn-outline-secondary" href="/admin-panel/users/">Reset</a>
    </form>
  </div>

  <div class="table-responsive border rounded">
    <table class="table table-sm table-striped align-middle mb-0">
      <thead class="table-light">
        <tr>
          <th>UID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Number</th>
          <th>Phone Verified</th>
          <th>Created</th>
          <th style="width:160px;">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for u in users %}
        <tr>
          <td><code>{{ u.uid }}</code></td>
          <td>{{ u.name }}</td>
          <td>{{ u.email }}</td>
          <td>{{ u.number }}</td>
          <td>{{ u.phoneVerified|yesno:"Yes,No" }}</td>
          <td>{{ u.createdAt }}</td>
          <td>
            <a class="btn btn-sm btn-primary" href="/admin-panel/users/{{ u.uid }}/edit/">Edit</a>
            <form method="post" action="/admin-panel/users/{{ u.uid }}/delete/" class="d-inline">{% csrf_token %}
              <button class="btn btn-sm btn-outline-danger" onclick="return confirm('Delete user and related data?')">Delete</button>
            </form>
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="7">No users.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}


